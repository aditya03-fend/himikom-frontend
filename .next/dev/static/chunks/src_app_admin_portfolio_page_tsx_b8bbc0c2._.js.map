{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/himikom-project/frontend/src/app/admin/portfolio/page.tsx"],"sourcesContent":["// src/app/admin/portfolio/page.tsx\r\n\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport Cookies from \"js-cookie\";\r\nimport { Plus, Trash2, Loader2, Globe, ExternalLink, CheckCircle, XCircle } from \"lucide-react\";\r\nimport { Portfolio } from \"@/types\";\r\nimport Image from \"next/image\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport default function AdminPortfolioPage() {\r\n  const [data, setData] = useState<Portfolio[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [userRole, setUserRole] = useState(\"\");\r\n\r\n  const fetchData = async () => {\r\n    // Ambil Role dari Cookies\r\n    setUserRole(Cookies.get(\"user_role\") || \"\");\r\n    \r\n    try {\r\n      const res = await fetch(\"http://localhost:4000/portfolio\", { cache: \"no-store\" });\r\n      setData(await res.json());\r\n    } catch (error) { console.error(error); } finally { setLoading(false); }\r\n  };\r\n\r\n  // --- FUNGSI UPDATE STATUS (PUBLISH / REJECT) ---\r\n  const handleStatusChange = async (id: string, newStatus: string) => {\r\n    const token = Cookies.get(\"token\");\r\n    try {\r\n      const res = await fetch(`http://localhost:4000/portfolio/${id}`, {\r\n        method: \"PATCH\",\r\n        headers: { \"Content-Type\": \"application/json\", \"Authorization\": `Bearer ${token}` },\r\n        body: JSON.stringify({ status: newStatus })\r\n      });\r\n      \r\n      if (res.ok) {\r\n        fetchData(); // Refresh data jika sukses\r\n      } else {\r\n        alert(\"Gagal mengupdate status.\");\r\n      }\r\n    } catch (e) { alert(\"Terjadi kesalahan koneksi.\"); }\r\n  };\r\n\r\n  // --- FUNGSI DELETE ---\r\n  const handleDelete = async (id: string) => {\r\n    if (!confirm(\"Hapus portfolio ini permanen?\")) return;\r\n    const token = Cookies.get(\"token\");\r\n    const res = await fetch(`http://localhost:4000/portfolio/${id}`, {\r\n      method: \"DELETE\",\r\n      headers: { \"Authorization\": `Bearer ${token}` }\r\n    });\r\n    if (res.ok) fetchData();\r\n  };\r\n\r\n  useEffect(() => { fetchData(); }, []);\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex items-center justify-between mb-8\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold font-heading\">Web Portfolio</h1>\r\n          <p className=\"text-gray-400 text-sm\">\r\n            Role Anda: <span className={cn(\"font-bold\", userRole === \"SUPER_ADMIN\" ? \"text-red-500\" : \"text-blue-500\")}>{userRole || \"USER\"}</span>\r\n          </p>\r\n        </div>\r\n        <Link href=\"/admin/portfolio/create\" className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-bold text-sm transition-colors\">\r\n          <Plus size={18} /> TAMBAH PORTFOLIO\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"bg-zinc-900 border border-white/10 rounded-xl overflow-hidden\">\r\n        {loading ? <div className=\"p-8 text-center\"><Loader2 className=\"animate-spin inline\" /></div> : (\r\n          <table className=\"w-full text-left\">\r\n            <thead className=\"bg-white/5 text-gray-400 text-xs uppercase\">\r\n              <tr>\r\n                <th className=\"p-4\">Status</th>\r\n                <th className=\"p-4\">Preview</th>\r\n                <th className=\"p-4\">Project & Mahasiswa</th>\r\n                <th className=\"p-4\">Link Website</th>\r\n                <th className=\"p-4 text-right\">Aksi</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-white/10\">\r\n              {data.map((item) => (\r\n                <tr key={item.id} className=\"hover:bg-white/5 transition-colors\">\r\n                  \r\n                  {/* KOLOM STATUS */}\r\n                  <td className=\"p-4\">\r\n                    <span className={cn(\"px-2 py-1 rounded text-[10px] font-bold border\", \r\n                      item.status === \"PUBLISHED\" ? \"bg-green-500/10 text-green-400 border-green-500/20\" : \r\n                      item.status === \"REJECTED\" ? \"bg-red-500/10 text-red-400 border-red-500/20\" : \r\n                      \"bg-yellow-500/10 text-yellow-400 border-yellow-500/20\")}>\r\n                      {item.status || \"PENDING\"}\r\n                    </span>\r\n                  </td>\r\n\r\n                  <td className=\"p-4 w-32\">\r\n                    <div className=\"relative w-24 h-16 rounded overflow-hidden bg-black border border-white/20\">\r\n                         <Image src={item.image} alt={item.title} fill className=\"object-cover\" />\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <div className=\"font-bold text-white\">{item.title}</div>\r\n                    <div className=\"text-sm text-gray-400\">{item.studentName}</div>\r\n                  </td>\r\n                  <td className=\"p-4\">\r\n                    <a href={item.link} target=\"_blank\" className=\"text-blue-400 hover:underline flex items-center gap-1 text-sm\">\r\n                        <Globe size={14} /> Kunjungi <ExternalLink size={12} />\r\n                    </a>\r\n                  </td>\r\n                  \r\n                  {/* KOLOM AKSI (Super Admin Logic) */}\r\n                  <td className=\"p-4 text-right\">\r\n                    <div className=\"flex justify-end gap-2\">\r\n                        \r\n                        {/* Tombol Approve (Hanya Super Admin & Belum Published) */}\r\n                        {userRole === \"SUPER_ADMIN\" && item.status !== \"PUBLISHED\" && (\r\n                            <button \r\n                                onClick={() => handleStatusChange(item.id, \"PUBLISHED\")} \r\n                                className=\"p-2 bg-green-900/30 text-green-400 rounded-lg hover:bg-green-600 hover:text-white transition-colors\"\r\n                                title=\"Approve / Publish\"\r\n                            >\r\n                                <CheckCircle size={16} />\r\n                            </button>\r\n                        )}\r\n\r\n                        {/* Tombol Reject (Hanya Super Admin & Masih Pending) */}\r\n                        {userRole === \"SUPER_ADMIN\" && item.status === \"PENDING\" && (\r\n                            <button \r\n                                onClick={() => handleStatusChange(item.id, \"REJECTED\")} \r\n                                className=\"p-2 bg-red-900/30 text-red-400 rounded-lg hover:bg-red-600 hover:text-white transition-colors\"\r\n                                title=\"Reject\"\r\n                            >\r\n                                <XCircle size={16} />\r\n                            </button>\r\n                        )}\r\n\r\n                        {/* Tombol Delete (Semua Admin bisa) */}\r\n                        <button \r\n                            onClick={() => handleDelete(item.id)} \r\n                            className=\"p-2 bg-gray-800 text-gray-400 rounded-lg hover:bg-red-900/50 hover:text-red-400 transition-colors\"\r\n                            title=\"Hapus Permanen\"\r\n                        >\r\n                            <Trash2 size={16} />\r\n                        </button>\r\n                    </div>\r\n                  </td>\r\n\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}
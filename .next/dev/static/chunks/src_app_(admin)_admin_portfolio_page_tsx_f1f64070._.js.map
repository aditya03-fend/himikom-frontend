{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/himikom-project/frontend/src/app/%28admin%29/admin/portfolio/page.tsx"],"sourcesContent":["// src/app/admin/portfolio/page.tsx\r\n\"use client\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\nimport Cookies from \"js-cookie\";\r\nimport { \r\n  Plus, \r\n  Loader2, \r\n  Globe, \r\n  MoreVertical, \r\n  Trash2, \r\n  CheckCircle, \r\n  RotateCcw, \r\n  XCircle, \r\n  ExternalLink \r\n} from \"lucide-react\";\r\nimport { Portfolio } from \"@/types\";\r\nimport Image from \"next/image\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport default function AdminPortfolioPage() {\r\n  const [data, setData] = useState<Portfolio[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [userRole, setUserRole] = useState(\"\");\r\n\r\n  // State for dropdown menu\r\n  const [openMenuId, setOpenMenuId] = useState<string | null>(null);\r\n\r\n  const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || \"http://localhost:3000\";\r\n\r\n  // --- FETCH DATA ---\r\n  const fetchData = async () => {\r\n    const role = Cookies.get(\"user_role\") || \"\";\r\n    const token = Cookies.get(\"token\");\r\n    setUserRole(role);\r\n    \r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/portfolio`, { \r\n        cache: \"no-store\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            \"Authorization\": `Bearer ${token}`\r\n        }\r\n      });\r\n      \r\n      if (!res.ok) throw new Error(\"Gagal ambil data\");\r\n      setData(await res.json());\r\n\r\n    } catch (error) { \r\n        console.error(error); \r\n    } finally { \r\n        setLoading(false); \r\n    }\r\n  };\r\n\r\n  // --- ACTIONS ---\r\n\r\n  // 1. Change Status (Publish / Unpublish / Reject)\r\n  const handleStatusChange = async (id: string, newStatus: string) => {\r\n    const token = Cookies.get(\"token\");\r\n    try {\r\n      const res = await fetch(`${baseUrl}/api/portfolio/${id}`, {\r\n        method: \"PATCH\",\r\n        headers: { \r\n            \"Content-Type\": \"application/json\", \r\n            \"Authorization\": `Bearer ${token}` \r\n        },\r\n        body: JSON.stringify({ status: newStatus })\r\n      });\r\n      \r\n      if (res.ok) {\r\n        fetchData(); // Refresh data\r\n        setOpenMenuId(null); // Close dropdown\r\n      } else {\r\n        alert(\"Gagal mengupdate status.\");\r\n      }\r\n    } catch (e) { \r\n        alert(\"Terjadi kesalahan koneksi.\"); \r\n    }\r\n  };\r\n\r\n  // 2. Delete Portfolio\r\n  const handleDelete = async (id: string) => {\r\n    if (!confirm(\"PERINGATAN: Hapus portfolio ini permanen?\")) return;\r\n    const token = Cookies.get(\"token\");\r\n    \r\n    try {\r\n        const res = await fetch(`${baseUrl}/api/portfolio/${id}`, {\r\n            method: \"DELETE\",\r\n            headers: { \"Authorization\": `Bearer ${token}` }\r\n        });\r\n        if (res.ok) fetchData();\r\n    } catch (error) {\r\n        alert(\"Gagal menghapus portfolio\");\r\n    }\r\n  };\r\n\r\n  // Logic Toggle Dropdown\r\n  const toggleMenu = (id: string) => {\r\n    if (openMenuId === id) setOpenMenuId(null);\r\n    else setOpenMenuId(id);\r\n  };\r\n\r\n  // Close dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = () => setOpenMenuId(null);\r\n    if(openMenuId) window.addEventListener('click', handleClickOutside);\r\n    return () => window.removeEventListener('click', handleClickOutside);\r\n  }, [openMenuId]);\r\n\r\n  useEffect(() => { fetchData(); }, []);\r\n\r\n  return (\r\n    <div className=\"min-h-screen pb-20\">\r\n      <div className=\"flex items-center justify-between mb-8\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold font-heading\">Web Portfolio</h1>\r\n          <p className=\"text-gray-400 text-sm\">\r\n             Login sebagai: <span className={cn(\"font-bold uppercase\", userRole === 'SUPER_ADMIN' ? \"text-red-500\" : \"text-blue-500\")}>{userRole.replace('_', ' ')}</span>\r\n          </p>\r\n        </div>\r\n        <Link href=\"/admin/portfolio/create\" className=\"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-bold text-sm transition-colors shadow-lg shadow-blue-900/20\">\r\n          <Plus size={18} /> TAMBAH PORTFOLIO\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"bg-zinc-900 border border-white/10 rounded-xl overflow-visible shadow-xl\">\r\n        {loading ? (\r\n            <div className=\"p-12 text-center flex flex-col items-center gap-3 text-gray-500\">\r\n                <Loader2 className=\"animate-spin w-8 h-8 text-blue-500\" />\r\n                <span className=\"text-sm\">Memuat portfolio...</span>\r\n            </div>\r\n        ) : data.length === 0 ? (\r\n            <div className=\"p-12 text-center text-gray-500\">\r\n                Belum ada data portfolio.\r\n            </div>\r\n        ) : (\r\n          <table className=\"w-full text-left border-collapse\">\r\n            <thead className=\"bg-white/5 text-gray-400 text-xs uppercase tracking-wider\">\r\n              <tr>\r\n                <th className=\"p-4 border-b border-white/10\">Status</th>\r\n                <th className=\"p-4 border-b border-white/10\">Preview</th>\r\n                <th className=\"p-4 border-b border-white/10\">Project & Mahasiswa</th>\r\n                <th className=\"p-4 border-b border-white/10\">Link Website</th>\r\n                <th className=\"p-4 border-b border-white/10 text-right\">Aksi</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody className=\"divide-y divide-white/10\">\r\n              {data.map((item) => (\r\n                <tr key={item.id} className=\"hover:bg-white/5 transition-colors group\">\r\n                  \r\n                  {/* STATUS COLUMN */}\r\n                  <td className=\"p-4\">\r\n                    <span className={cn(\"px-2 py-1 rounded text-[10px] font-bold border uppercase\", \r\n                      item.status === \"PUBLISHED\" ? \"bg-green-500/10 text-green-400 border-green-500/20\" : \r\n                      item.status === \"REJECTED\" ? \"bg-red-500/10 text-red-400 border-red-500/20\" : \r\n                      \"bg-yellow-500/10 text-yellow-400 border-yellow-500/20\")}>\r\n                      {item.status || \"PENDING\"}\r\n                    </span>\r\n                  </td>\r\n\r\n                  {/* PREVIEW IMAGE */}\r\n                  <td className=\"p-4 w-32\">\r\n                    <div className=\"relative w-24 h-16 rounded overflow-hidden bg-black border border-white/20\">\r\n                         <Image \r\n                            src={item.image || \"/placeholder.jpg\"} \r\n                            alt={item.title} \r\n                            fill \r\n                            className=\"object-cover\" \r\n                         />\r\n                    </div>\r\n                  </td>\r\n\r\n                  {/* INFO */}\r\n                  <td className=\"p-4\">\r\n                    <div className=\"font-bold text-white\">{item.title}</div>\r\n                    <div className=\"text-sm text-gray-400\">{item.studentName}</div>\r\n                  </td>\r\n\r\n                  {/* LINK */}\r\n                  <td className=\"p-4\">\r\n                    <a href={item.link} target=\"_blank\" className=\"text-blue-400 hover:underline flex items-center gap-1 text-sm\">\r\n                        <Globe size={14} /> Kunjungi <ExternalLink size={12} />\r\n                    </a>\r\n                  </td>\r\n                  \r\n                  {/* ACTIONS (DROPDOWN) */}\r\n                  <td className=\"p-4 text-right relative\">\r\n                    {userRole === \"SUPER_ADMIN\" ? (\r\n                        <div className=\"relative inline-block text-left\" onClick={(e) => e.stopPropagation()}>\r\n                            <button \r\n                                onClick={() => toggleMenu(item.id)}\r\n                                className=\"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-full transition-all\"\r\n                            >\r\n                                <MoreVertical size={20} />\r\n                            </button>\r\n\r\n                            {/* Dropdown Content */}\r\n                            {openMenuId === item.id && (\r\n                                <div className=\"absolute right-0 mt-2 w-52 bg-zinc-950 border border-white/10 rounded-xl shadow-2xl z-50 overflow-hidden animate-in fade-in zoom-in-95 duration-200\">\r\n                                    <div className=\"py-1\">\r\n                                        \r\n                                        {/* SUPER ADMIN ACTIONS ONLY (NO EDIT) */}\r\n                                        \r\n                                        {/* Approve / Publish */}\r\n                                        {item.status !== \"PUBLISHED\" && (\r\n                                            <button \r\n                                                onClick={() => handleStatusChange(item.id, \"PUBLISHED\")}\r\n                                                className=\"flex items-center gap-3 px-4 py-3 text-sm text-gray-300 hover:bg-green-500/10 hover:text-green-400 transition-colors w-full text-left border-t border-white/5\"\r\n                                            >\r\n                                                <CheckCircle size={16} /> Approve (Publish)\r\n                                            </button>\r\n                                        )}\r\n\r\n                                        {/* Reject */}\r\n                                        {item.status === \"PENDING\" && (\r\n                                            <button \r\n                                                onClick={() => handleStatusChange(item.id, \"REJECTED\")}\r\n                                                className=\"flex items-center gap-3 px-4 py-3 text-sm text-gray-300 hover:bg-red-500/10 hover:text-red-400 transition-colors w-full text-left\"\r\n                                            >\r\n                                                <XCircle size={16} /> Reject\r\n                                            </button>\r\n                                        )}\r\n\r\n                                        {/* Unpublish */}\r\n                                        {item.status === \"PUBLISHED\" && (\r\n                                            <button \r\n                                                onClick={() => handleStatusChange(item.id, \"PENDING\")}\r\n                                                className=\"flex items-center gap-3 px-4 py-3 text-sm text-yellow-500 hover:bg-yellow-500/10 hover:text-yellow-400 transition-colors w-full text-left border-t border-white/5\"\r\n                                            >\r\n                                                <RotateCcw size={16} /> Batal Publish\r\n                                            </button>\r\n                                        )}\r\n\r\n                                        {/* Delete */}\r\n                                        <button \r\n                                            onClick={() => handleDelete(item.id)}\r\n                                            className=\"flex items-center gap-3 px-4 py-3 text-sm text-red-400 hover:bg-red-900/20 hover:text-red-300 transition-colors w-full text-left border-t border-white/10\"\r\n                                        >\r\n                                            <Trash2 size={16} /> Hapus Permanen\r\n                                        </button>\r\n\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ) : (\r\n                        // ADMIN BIASA (NO ACTION)\r\n                        <span className=\"text-gray-600 text-[10px] italic pr-2\">\r\n                            Akses Terbatas\r\n                        </span>\r\n                    )}\r\n                  </td>\r\n\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}